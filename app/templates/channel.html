{% extends 'base.html' %}

{% block title %}{{ channel.name }}{% endblock %}

{% block page_content %}
    <h1>这是{{ channel.name }}</h1>
    {% if current_user is not none %}
    <form class="pure-form" action="{{ channel.id }}/add_post" method="POST">
        <label for="title">标题</label>
        <br>
        <input name="title" class="form-control" />
        <br>
        <label for="content">内容</label>
        <br>
        <input name="content" class="form-control" />
        <br>
        <button class="pure-button pure-button-primary">提交</button>
    </form>
    {% endif %}
    <hr>
    <h2>帖子列表</h2>
    {% for p in posts %}
        {% set author_name = p.author.username %}
        <p>
            <a href="{{ url_for('post', id=p.id) }}">{{ p.title }}</a>
            | 作者: <a href="{{ url_for('profile', username=author_name) }}">{{ author_name }}</a>
            | {{ p.created_time }}
        </p>
        {% set content = p.content %}
        {% set content_len = content.__len__() %}
        {% if content_len > 20 %}
            {% set content = content[:20] + '...' %}
        {% endif %}
        <p>
            {{ content }}
        </p>
    {% endfor %}
{% endblock %}